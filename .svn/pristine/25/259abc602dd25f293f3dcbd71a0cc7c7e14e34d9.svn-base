using System;
using System.Collections.Generic;
using MYZJ.VIP.ServiceModel;
using Myzj.MKMS.ServiceModel.WebAward;
using Myzj.OPC.UI.Model.PdtUser;
using Myzj.OPC.UI.Model.WebAward;
using AddWebAwardLotteryNumberRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardLotteryNumberRequest;
using AddWebAwardLotteryNumberResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardLotteryNumberResponse;
using AddWebAwardPrizeRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardPrizeRequest;
using AddWebAwardPrizeResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardPrizeResponse;
using AddWebAwardRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardRequest;
using AddWebAwardResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardResponse;
using AddWebAwardUserTagsRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardUserTagsRequest;
using AddWebAwardUserTagsResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardUserTagsResponse;
using AddWebPrizeBundleRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebPrizeBundleRequest;
using AddWebPrizeBundleResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebPrizeBundleResponse;
using DelWebAwardPrizeItemRequest = Myzj.MKMS.ServiceModel.WebAward.DelWebAwardPrizeItemRequest;
using DelWebAwardPrizeItemResponse = Myzj.MKMS.ServiceModel.WebAward.DelWebAwardPrizeItemResponse;
using QueryWebAwardByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardByIdRequest;
using QueryWebAwardByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardByIdResponse;
using QueryWebAwardLotteryNumberByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardLotteryNumberByIdRequest;
using QueryWebAwardLotteryNumberByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardLotteryNumberByIdResponse;
using QueryWebAwardLotteryNumberRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardLotteryNumberRequest;
using QueryWebAwardLotteryNumberResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardLotteryNumberResponse;
using QueryWebAwardPrizeByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeByIdRequest;
using QueryWebAwardPrizeByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeByIdResponse;
using QueryWebAwardPrizeItemByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeItemByIdRequest;
using QueryWebAwardPrizeItemByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeItemByIdResponse;
using QueryWebAwardPrizeItemRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeItemRequest;
using QueryWebAwardPrizeItemResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeItemResponse;
using QueryWebAwardPrizeModelRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeModelRequest;
using QueryWebAwardPrizeModelResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeModelResponse;
using QueryWebAwardPrizeRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeRequest;
using QueryWebAwardPrizeResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardPrizeResponse;
using QueryWebAwardRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardRequest;
using QueryWebAwardResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardResponse;
using QueryWebAwardUserTagsByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardUserTagsByIdRequest;
using QueryWebAwardUserTagsByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardUserTagsByIdResponse;
using QueryWebAwardUserTagsRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardUserTagsRequest;
using QueryWebAwardUserTagsResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebAwardUserTagsResponse;
using QueryWebLotteryTemplateConfigureRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebLotteryTemplateConfigureRequest;
using QueryWebLotteryTemplateConfigureResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebLotteryTemplateConfigureResponse;
using QueryWebLotteryTemplateRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebLotteryTemplateRequest;
using QueryWebLotteryTemplateResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebLotteryTemplateResponse;
using QueryWebPrizeBundleByIdRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebPrizeBundleByIdRequest;
using QueryWebPrizeBundleByIdResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebPrizeBundleByIdResponse;
using QueryWebPrizeBundleRequest = Myzj.MKMS.ServiceModel.WebAward.QueryWebPrizeBundleRequest;
using QueryWebPrizeBundleResponse = Myzj.MKMS.ServiceModel.WebAward.QueryWebPrizeBundleResponse;
using UpdateWebAwardLotteryNumberRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardLotteryNumberRequest;
using UpdateWebAwardLotteryNumberResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardLotteryNumberResponse;
using UpdateWebAwardLotteryNumberStateRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardLotteryNumberStateRequest;
using UpdateWebAwardLotteryNumberStateResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardLotteryNumberStateResponse;
using UpdateWebAwardPrizeRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeRequest;
using UpdateWebAwardPrizeResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeResponse;
using UpdateWebAwardPrizeStateRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeStateRequest;
using UpdateWebAwardPrizeStateResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeStateResponse;
using UpdateWebAwardRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardRequest;
using UpdateWebAwardResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardResponse;
using UpdateWebAwardStatusRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardStatusRequest;
using UpdateWebAwardStatusResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardStatusResponse;
using UpdateWebAwardUserTagsRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardUserTagsRequest;
using UpdateWebAwardUserTagsResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardUserTagsResponse;
using UpdateWebAwardUserTagsStateRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardUserTagsStateRequest;
using UpdateWebAwardUserTagsStateResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardUserTagsStateResponse;
using UpdateWebPrizeBundleRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebPrizeBundleRequest;
using UpdateWebPrizeBundleResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebPrizeBundleResponse;
using UpdateWebPrizeBundleStateRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebPrizeBundleStateRequest;
using UpdateWebPrizeBundleStateResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebPrizeBundleStateResponse;
using Web_AwardExt = Myzj.MKMS.ServiceModel.WebAward.Web_AwardExt;
using Web_Award_LotteryNumberExt = Myzj.MKMS.ServiceModel.WebAward.Web_Award_LotteryNumberExt;
using Web_Award_PrizeExt = Myzj.MKMS.ServiceModel.WebAward.Web_Award_PrizeExt;
using Web_Award_PrizeItemExt = Myzj.MKMS.ServiceModel.WebAward.Web_Award_PrizeItemExt;
using Web_Award_PrizeModelExt = Myzj.MKMS.ServiceModel.WebAward.Web_Award_PrizeModelExt;
using Web_Award_UserTagsExt = Myzj.MKMS.ServiceModel.WebAward.Web_Award_UserTagsExt;
using Web_LotteryTemplateConfigureExt = Myzj.MKMS.ServiceModel.WebAward.Web_LotteryTemplateConfigureExt;
using Web_LotteryTemplateExt = Myzj.MKMS.ServiceModel.WebAward.Web_LotteryTemplateExt;
using Web_PrizeBundleExt = Myzj.MKMS.ServiceModel.WebAward.Web_PrizeBundleExt;
using UpdateWebAwardPrizeItemRequest = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeItemRequest;
using UpdateWebAwardPrizeItemResponse = Myzj.MKMS.ServiceModel.WebAward.UpdateWebAwardPrizeItemResponse;
using AddWebAwardPrizeItemRequest = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardPrizeItemRequest;
using AddWebAwardPrizeItemResponse = Myzj.MKMS.ServiceModel.WebAward.AddWebAwardPrizeItemResponse;



namespace Myzj.OPC.UI.ServiceClient
{
    public class WebAwardClient : BaseService
    {
        private WebAwardClient()
        {
        }

        private static readonly object Lockobj = new object();
        private static WebAwardClient _instance;

        public static WebAwardClient Instance
        {
            get
            {
                if (_instance == null)
                {
                    lock (Lockobj)
                    {
                        if (_instance == null)
                        {
                            _instance = new WebAwardClient();
                        }
                    }
                }
                return _instance;
            }
        }

        //***********************dbo.Web_Award*********************************

        #region 抽奖活动列表

        /// <summary>
        /// 抽奖活动列表
        /// </summary>
        /// <param name="webAward"></param>
        /// <returns></returns>
        public WebAwardRefer QueryWebAward(WebAwardRefer webAward)
        {
            var result = new WebAwardRefer();
            var req = new QueryWebAwardRequest();
            if (webAward.SearchDetail != null)
            {
                req.VchAwardName = webAward.SearchDetail.VchAwardName;
                req.DtStartTime = webAward.SearchDetail.DtStartTime;
                req.DtEndTime = webAward.SearchDetail.DtEndTime;
                req.IntStatus = webAward.SearchDetail.IntStatus;
            }
            req.PageIndex = webAward.PageIndex;
            req.PageSize = webAward.PageSize;

            var res = MKMSClient.Send<QueryWebAwardResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_AwardExt, WebAwardDetail>(res.WebAwardDos);
                result.Total = res.Total;
            }
            result.SearchDetail = webAward.SearchDetail;
            result.PageIndex = webAward.PageIndex;
            result.PageSize = webAward.PageSize;

            return result;
        }

        #endregion

        #region 根据Id查询单条信息

        /// <summary>
        /// 根据Id查询单条信息
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public WebAwardDetail QueryWebAwardById(WebAwardDetail webAward)
        {
            var result = new WebAwardDetail();
            var req = new QueryWebAwardByIdRequest();
            req.IntAwardId = webAward.IntAwardId;

            var res = MKMSClient.Send<QueryWebAwardByIdResponse>(req);
            result = Mapper.Map<Web_AwardExt, WebAwardDetail>(res.WebAwardDos);
            return result;
        }

        #endregion

        #region 新增抽奖活动

        /// <summary>
        /// 新增抽奖活动
        /// </summary>
        /// <param name="webAward"></param>
        /// <returns></returns>
        public bool AddWebAward(WebAwardDetail webAward)
        {
            var req = Mapper.Map<WebAwardDetail, AddWebAwardRequest>(webAward);
            var res = MKMSClient.Send<AddWebAwardResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改抽奖活动

        /// <summary>
        /// 新增抽奖活动
        /// </summary>
        /// <param name="webAward"></param>
        /// <returns></returns>
        public bool UpdateWebAward(WebAwardDetail webAward)
        {
            var req = Mapper.Map<WebAwardDetail, UpdateWebAwardRequest>(webAward);
            var res = MKMSClient.Send<UpdateWebAwardResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改抽奖活动状态

        /// <summary>
        /// 修改抽奖活动状态
        /// </summary>
        /// <param name="id"></param>
        /// <param name="state"></param>
        /// <returns></returns>
        public bool UpdateWebAwardStatus(int id, int state)
        {
            var req = new UpdateWebAwardStatusRequest();
            req.IntAwardId = id;
            req.IntStatus = state;
            var res = MKMSClient.Send<UpdateWebAwardStatusResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 根据用户Id查询用户名称
        /// <summary>
        /// 根据用户Id查询用户名称
        /// </summary>
        /// <param name="userId"></param>
        /// <returns></returns>
        public PdtUserDetail GetUserName(int? userId)
        {
            var result = new PdtUserDetail();
            var req = new QuerypttuserByIdRequest();
            req.UserId = userId;
            var res = OpcClient.Send<QuerypttuserByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<pt_t_userExt, PdtUserDetail>(res.UserDos);
            }
            return result;
        }

        #endregion

        //***********************dbo.WebAwardUserTags*********************************

        #region 用户标签组配置列表

        /// <summary>
        /// 用户标签组配置列表
        /// </summary>
        /// <param name="userTags"></param>
        /// <returns></returns>
        public WebAwardUserTagsRefer QueryWebAwardUserTags(WebAwardUserTagsRefer userTags)
        {
            var result = new WebAwardUserTagsRefer();
            var req = new QueryWebAwardUserTagsRequest();
            if (userTags.SearchDetail != null)
            {
                req.IntAwardId = userTags.SearchDetail.IntAwardId;
                req.VchTagsName = userTags.SearchDetail.VchTagsName;
                req.IntStatus = userTags.SearchDetail.IntStatus;
            }
            var res = MKMSClient.Send<QueryWebAwardUserTagsResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_Award_UserTagsExt, WebAwardUserTagsDetail>(res.WebAwardUserTagsDos);
                result.Total = res.Total;
            }
            result.SearchDetail = userTags.SearchDetail;
            return result;
        }

        #endregion

        #region 根据用户标签组配置Id查询单条信息

        /// <summary>
        /// 根据用户标签组配置Id查询单条信息
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public WebAwardUserTagsDetail QueryWebAwardUserTagsById(int id)
        {
            var result = new WebAwardUserTagsDetail();

            var req = new QueryWebAwardUserTagsByIdRequest();
            req.IntTagsId = id;
            var res = MKMSClient.Send<QueryWebAwardUserTagsByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_Award_UserTagsExt, WebAwardUserTagsDetail>(res.WebAwardUserTagsDos);
            }
            return result;
        }

        #endregion

        #region 新增用户标签组配置

        /// <summary>
        /// 新增用户标签组配置
        /// </summary>
        /// <param name="userTags"></param>
        /// <returns></returns>
        public bool AddWebAwardUserTags(WebAwardUserTagsDetail userTags)
        {
            var req = Mapper.Map<WebAwardUserTagsDetail, AddWebAwardUserTagsRequest>(userTags);
            var res = MKMSClient.Send<AddWebAwardUserTagsResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改用户标签组配置

        /// <summary>
        /// 修改用户标签组配置
        /// </summary>
        /// <param name="userTags"></param>
        /// <returns></returns>
        public bool UpdateWebAwardUserTags(WebAwardUserTagsDetail userTags)
        {
            var req = Mapper.Map<WebAwardUserTagsDetail, UpdateWebAwardUserTagsRequest>(userTags);
            var res = MKMSClient.Send<UpdateWebAwardUserTagsResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改用户标签组配置状态

        /// <summary>
        /// 修改用户标签组配置状态
        /// </summary>
        /// <param name="id"></param>
        /// <param name="state"></param>
        /// <returns></returns>
        public bool UpdateWebAwardUserTagsState(int id, int state)
        {
            var req = new UpdateWebAwardUserTagsStateRequest();
            req.IntTagsId = id;
            req.IntStatus = state;
            var res = MKMSClient.Send<UpdateWebAwardUserTagsStateResponse>(req);
            return res.DoFlag;
        }

        #endregion

        //***********************dbo.Web_Award_LotteryNumber*********************************

        #region 抽奖次数配置列表

        /// <summary>
        /// 抽奖次数配置列表
        /// </summary>
        /// <param name="lotteryNumber"></param>
        /// <returns></returns>
        public WebLotteryNumberRefer QueryWebAwardLotteryNumber(WebLotteryNumberRefer lotteryNumber)
        {
            var result = new WebLotteryNumberRefer();

            var req = new QueryWebAwardLotteryNumberRequest();
            if (lotteryNumber.SearchDetail != null)
            {
                req.IntTagsId = lotteryNumber.SearchDetail.IntTagsId;
            }
            var res = MKMSClient.Send<QueryWebAwardLotteryNumberResponse>(req);
            if (res.DoFlag)
            {
                result.List =
                    Mapper.MappGereric<Web_Award_LotteryNumberExt, WebLotteryNumberDetail>(res.LotteryNumberDos);
            }
            result.SearchDetail = lotteryNumber.SearchDetail;
            return result;
        }

        #endregion

        #region 根据抽奖次数配置Id查询单条信息

        /// <summary>
        /// 根据抽奖次数配置Id查询单条信息
        /// </summary>
        /// <param name="lotteryNumber"></param>
        /// <returns></returns>
        public WebLotteryNumberDetail QueryWebAwardLotteryNumberById(WebLotteryNumberDetail lotteryNumber)
        {
            var result = new WebLotteryNumberDetail();
            var req = new QueryWebAwardLotteryNumberByIdRequest();
            req.IntNumId = lotteryNumber.IntNumId;

            var res = MKMSClient.Send<QueryWebAwardLotteryNumberByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_Award_LotteryNumberExt, WebLotteryNumberDetail>(res.LotteryNumberDos);
            }
            return result;
        }

        #endregion

        #region 新增抽奖次数配置

        /// <summary>
        /// 新增抽奖次数配置
        /// </summary>
        /// <param name="LotteryNumber"></param>
        /// <returns></returns>
        public bool AddWebAwardLotteryNumber(WebLotteryNumberDetail LotteryNumber)
        {
            var req = Mapper.Map<WebLotteryNumberDetail, AddWebAwardLotteryNumberRequest>(LotteryNumber);
            var res = MKMSClient.Send<AddWebAwardLotteryNumberResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改抽奖次数配置

        /// <summary>
        /// 新增抽奖次数配置
        /// </summary>
        /// <param name="LotteryNumber"></param>
        /// <returns></returns>
        public bool UpdateWebAwardLotteryNumber(WebLotteryNumberDetail LotteryNumber)
        {
            var req = Mapper.Map<WebLotteryNumberDetail, UpdateWebAwardLotteryNumberRequest>(LotteryNumber);
            var res = MKMSClient.Send<UpdateWebAwardLotteryNumberResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改抽奖次数配置状态

        /// <summary>
        /// 修改抽奖次数配置状态
        /// </summary>
        /// <returns></returns>
        public bool UpdateWebAwardLotteryNumberState(int id, int state)
        {
            var req = new UpdateWebAwardLotteryNumberStateRequest();
            req.IntNumId = id;
            req.IntStatus = state;
            var res = MKMSClient.Send<UpdateWebAwardLotteryNumberStateResponse>(req);

            return res.DoFlag;
        }

        #endregion

        //***********************dbo.Web_Award_Prize*********************************

        #region 奖项配置列表
        /// <summary>
        ///  奖项配置列表
        /// </summary>
        /// <param name="webPrize"></param>
        /// <returns></returns>
        public WebPrizeRefer QueryWebAwardPrize(WebPrizeRefer webPrize)
        {
            var result = new WebPrizeRefer();
            var req = new QueryWebAwardPrizeRequest();
            if (webPrize.SearchDetail != null)
            {
                req.IntAwardId = webPrize.SearchDetail.IntAwardId;
                req.VchPrizeName = webPrize.SearchDetail.VchPrizeName;
                req.IntPrizeNo = webPrize.SearchDetail.IntPrizeNo;
                req.IntPrizeWeight = webPrize.SearchDetail.IntPrizeWeight;
                req.IntPrizeCount = webPrize.SearchDetail.IntPrizeCount;
                req.IntStatus = webPrize.SearchDetail.IntStatus;
                req.IntNumId = webPrize.SearchDetail.IntNumId;
            }
            var res = MKMSClient.Send<QueryWebAwardPrizeResponse>(req);

            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_Award_PrizeExt, WebPrizeDetail>(res.WebAwardPrizeDos);
            }
            result.SearchDetail = webPrize.SearchDetail;

            return result;
        }

        #endregion

        #region 根据奖项配置ID查询单条信息

        /// <summary>
        /// 根据奖项配置ID查询单条信息
        /// </summary>
        /// <param name="webPrize"></param>
        /// <returns></returns>
        public WebPrizeDetail QueryWebAwardPrizeById(WebPrizeDetail webPrize)
        {
            var result = new WebPrizeDetail();
            var req = new QueryWebAwardPrizeByIdRequest();
            req.IntPrizeId = webPrize.IntPrizeId;

            var res = MKMSClient.Send<QueryWebAwardPrizeByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_Award_PrizeExt, WebPrizeDetail>(res.WebAwardPrizeDos);
            }
            return result;
        }

        #endregion

        #region 新增奖项配置
        /// <summary>
        /// 新增奖项配置
        /// </summary>
        /// <param name="webPrize"></param>
        /// <returns></returns>
        public bool AddWebAwardPrize(WebPrizeDetail webPrize)
        {
            var req = Mapper.Map<WebPrizeDetail, AddWebAwardPrizeRequest>(webPrize);
            var res = MKMSClient.Send<AddWebAwardPrizeResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改奖项配置

        public bool UpdateWebAwardPrize(WebPrizeDetail webPrize)
        {
            var req = Mapper.Map<WebPrizeDetail, UpdateWebAwardPrizeRequest>(webPrize);
            var res = MKMSClient.Send<UpdateWebAwardPrizeResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改奖项配置状态

        public bool UpdateWebAwardPrizeState(int id, int state)
        {
            var req = new UpdateWebAwardPrizeStateRequest();
            req.IntPrizeId = id;
            req.IntStatus = state;
            var res = MKMSClient.Send<UpdateWebAwardPrizeStateResponse>(req);
            return res.DoFlag;
        }

        #endregion

        //***********************dbo.Web_Award_PrizeItem*********************************

        #region 奖品配置列表
        /// <summary>
        ///  奖品配置列表
        /// </summary>
        /// <param name="prizeItem"></param>
        /// <returns></returns>
        public WebPrizeItemRefer QueryWebAwardPrizeItem(WebPrizeItemRefer prizeItem)
        {
            var result = new WebPrizeItemRefer();
            var req = new QueryWebAwardPrizeItemRequest();
            if (prizeItem.SearchDetail != null)
            {
                req.IntAwardId = prizeItem.SearchDetail.IntAwardId;
                req.IntPrizeId = prizeItem.SearchDetail.IntPrizeId;
                req.IntPrizeType = prizeItem.SearchDetail.IntPrizeType;
                req.IntPrizeCaseId = prizeItem.SearchDetail.IntPrizeCaseId;
                req.IntIsExclusive = prizeItem.SearchDetail.IntIsExclusive;
                req.DtStartTime = prizeItem.SearchDetail.DtStartTime;
                req.DtEndTime = prizeItem.SearchDetail.DtEndTime;
            }
            var res = MKMSClient.Send<QueryWebAwardPrizeItemResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_Award_PrizeItemExt, WebPrizeItemDetail>(res.AwardPrizeItemDos);
            }
            result.SearchDetail = prizeItem.SearchDetail;
            return result;
        }

        #endregion

        #region 根据奖品配置Id查询单条信息
        /// <summary>
        /// 根据奖品配置Id查询单条信息
        /// </summary>
        /// <param name="prizeItem"></param>
        /// <returns></returns>
        public WebPrizeItemDetail QueryWebAwardPrizeItemById(int id)
        {
            var result = new WebPrizeItemDetail();
            var req = new QueryWebAwardPrizeItemByIdRequest();
            req.IntPrizeItemId = id;
            var res = MKMSClient.Send<QueryWebAwardPrizeItemByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_Award_PrizeItemExt, WebPrizeItemDetail>(res.AwardPrizeItemDos);
            }
            return result;
        }

        #endregion

        #region 删除奖品配置

        /// <summary>
        /// 删除奖品配置
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public bool DelWebAwardPrizeItem(int id)
        {
            var req = new DelWebAwardPrizeItemRequest();
            req.IntPrizeItemId = id;
            var res = MKMSClient.Send<DelWebAwardPrizeItemResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 获取抽奖模型表

        /// <summary>
        /// 获取抽奖模型表
        /// </summary>
        /// <param name="type"></param>
        /// <returns></returns>
        public List<WebLotteryTemplateDetail> QueryWebLotteryTemplate(int type)
        {
            var result = new List<WebLotteryTemplateDetail>();
            var req = new QueryWebLotteryTemplateRequest();
            req.TempType = type;
            var res = MKMSClient.Send<QueryWebLotteryTemplateResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.MappGereric<Web_LotteryTemplateExt, WebLotteryTemplateDetail>(res.LotteryTemplateDos);
            }
            return result;
        }

        #endregion

        #region 根据抽奖模块Id查询Web_LotteryTemplateConfigure对应的配置
        /// <summary>
        /// 根据抽奖模块Id查询Web_LotteryTemplateConfigure对应的配置
        /// </summary>
        /// <param name="ltSysNos"></param>
        /// <returns></returns>
        public List<WebLotteryTempConDetail> QueryWebLotteryTemplateConfigure(int ltSysNos)
        {
            var result = new List<WebLotteryTempConDetail>();
            var req = new QueryWebLotteryTemplateConfigureRequest();
            req.LtSysNos = ltSysNos;
            var res = MKMSClient.Send<QueryWebLotteryTemplateConfigureResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.MappGereric<Web_LotteryTemplateConfigureExt, WebLotteryTempConDetail>(res.TemplateConfigureDos);
            }
            return result;
        }

        #endregion

        #region 根据抽奖模型Id查询Value值
        /// <summary>
        ///  根据抽奖模型Id查询Value值
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public WebLotteryTempConDetail QueryWebLotteryTemplateById(int id)
        {
            var result = new WebLotteryTempConDetail();
            var req = new QueryTemplateConfigureByIdRequest();
            req.ConSysNos = id;
            var res = MKMSClient.Send<QueryTemplateConfigureByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_LotteryTemplateConfigureExt, WebLotteryTempConDetail>(res.ConfigureDos);
            }
            return result;
        }
        #endregion

        #region 修改奖品配置
        /// <summary>
        /// 修改奖品配置
        /// </summary>
        /// <returns></returns>
        public bool UpdateWebAwardPrizeItem(WebPrizeItemDetail prizeItem)
        {
            var req = Mapper.Map<WebPrizeItemDetail, UpdateWebAwardPrizeItemRequest>(prizeItem);
            var res = MKMSClient.Send<UpdateWebAwardPrizeItemResponse>(req);
            return res.DoFlag;
        }
        #endregion

        #region 新增奖品配置
        /// <summary>
        /// 新增奖品配置
        /// </summary>
        /// <returns></returns>
        public bool AddWebAwardPrizeItem(WebPrizeItemDetail prizeItem)
        {
            var req = Mapper.Map<WebPrizeItemDetail, AddWebAwardPrizeItemRequest>(prizeItem);
            var res = MKMSClient.Send<AddWebAwardPrizeItemResponse>(req);
            return res.DoFlag;
        }
        #endregion

        //***********************dbo.Web_Award_PrizeModel*********************************

        #region 活动类型列表

        /// <summary>
        /// 活动类型列表
        /// </summary>
        /// <returns></returns>
        public WebPrizeModelRefer QueryWebAwardPrizeModel()
        {
            var result = new WebPrizeModelRefer();

            var req = new QueryWebAwardPrizeModelRequest();
            var res = MKMSClient.Send<QueryWebAwardPrizeModelResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_Award_PrizeModelExt, WebPrizeModelDetail>(res.PrizeModelDos);
            }
            return result;
        }

        #endregion

        //***********************dbo.Web_Prize_Bundle*********************************

        #region 捆绑奖品列表

        /// <summary>
        /// 捆绑奖品列表
        /// </summary>
        /// <param name="prizeBundle"></param>
        /// <returns></returns>
        public WebPrizeBundleRefer QueryWebPrizeBundle(WebPrizeBundleRefer prizeBundle)
        {
            var result = new WebPrizeBundleRefer();
            var req = new QueryWebPrizeBundleRequest();
            if (prizeBundle.SearchDetail != null)
            {
                req.IntPrizeItemId = prizeBundle.SearchDetail.IntPrizeItemId;
                req.PrizeCaseId = prizeBundle.SearchDetail.PrizeCaseId;
                req.IntStatus = prizeBundle.SearchDetail.IntStatus;
                req.DtStartTime = prizeBundle.SearchDetail.DtStartTime;
                req.DtEndTime = prizeBundle.SearchDetail.DtEndTime;
            }
            var res = MKMSClient.Send<QueryWebPrizeBundleResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_PrizeBundleExt, WebPrizeBundleDetail>(res.WebPrizeBundleDos);
            }
            result.SearchDetail = prizeBundle.SearchDetail;

            return result;
        }

        #endregion

        #region 根据捆绑奖品Id查询单条信息

        /// <summary>
        /// 根据捆绑奖品Id查询单条信息
        /// </summary>
        /// <param name="prizeBundle"></param>
        /// <returns></returns>
        public WebPrizeBundleDetail QueryWebPrizeBundleById(WebPrizeBundleDetail prizeBundle)
        {
            var result = new WebPrizeBundleDetail();
            var req = new QueryWebPrizeBundleByIdRequest();
            req.BSysNos = prizeBundle.BSysNos;
            var res = MKMSClient.Send<QueryWebPrizeBundleByIdResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<Web_PrizeBundleExt, WebPrizeBundleDetail>(res.WebPrizeBundleDos);
            }
            return result;
        }

        #endregion

        #region 新增捆绑奖品

        /// <summary>
        /// 新增捆绑奖品
        /// </summary>
        /// <param name="prizeBundle"></param>
        /// <returns></returns>
        public bool AddWebPrizeBundle(WebPrizeBundleDetail prizeBundle)
        {
            var req = Mapper.Map<WebPrizeBundleDetail, AddWebPrizeBundleRequest>(prizeBundle);
            var res = MKMSClient.Send<AddWebPrizeBundleResponse>(req);
            return res.DoFlag;
        }

        #endregion

        #region 修改捆绑奖品
        /// <summary>
        /// 修改捆绑奖品
        /// </summary>
        /// <param name="prizeBundle"></param>
        /// <returns></returns>
        public bool UpdateWebPrizeBundle(WebPrizeBundleDetail prizeBundle)
        {
            var req = Mapper.Map<WebPrizeBundleDetail, UpdateWebPrizeBundleRequest>(prizeBundle);
            var res = MKMSClient.Send<UpdateWebPrizeBundleResponse>(req);
            return res.DoFlag;
        }
        #endregion

        #region 修改捆绑奖品状态
        /// <summary>
        /// 修改捆绑奖品状态
        /// </summary>
        /// <returns></returns>
        public bool UpdateWebPrizeBundleState(int id, int state)
        {
            var req = new UpdateWebPrizeBundleStateRequest();
            req.BSysNos = id;
            req.IntStatus = state;
            var res = MKMSClient.Send<UpdateWebPrizeBundleStateResponse>(req);
            return res.DoFlag;
        }

        #endregion


        //***********************dbo.Web_Award_Record*********************************

        #region 拉取特殊奖品明细/抽奖明细
        /// <summary>
        /// 拉取特殊奖品明细/抽奖明细
        /// </summary>
        /// <param name="id"></param>
        /// <param name="recordDetail"></param>
        /// <returns></returns>
        public WebAwardRecordRefer QueryWebAwardRecordItem(WebAwardRecordRefer recordDetail)
        {
            var result = new WebAwardRecordRefer();
            var req = new QueryWebAwardRecordRequest();

            if (recordDetail.SearchDetail != null)
            {
                req.IntAwardId = recordDetail.SearchDetail.IntAwardId;
                req.IntUserId = recordDetail.SearchDetail.IntUserId;
                req.VchEmail = recordDetail.SearchDetail.VchEmail;
                req.VchLoginMobile = recordDetail.SearchDetail.VchLoginMobile;
                req.IntPrizeNo = recordDetail.SearchDetail.IntPrizeNo;
                req.IntPrizeType = recordDetail.SearchDetail.IntPrizeType;
                req.IntPrizeCaseId = recordDetail.SearchDetail.IntPrizeCaseId;
                req.DtStartCreateTime = recordDetail.SearchDetail.DtCreateTime;
                req.DtEndCreateTime = recordDetail.SearchDetail.DtEndCreateTime;
            }
            req.PageIndex = recordDetail.PageIndex;
            req.PageSize = recordDetail.PageSize;

            var res = MKMSClient.Send<QueryWebAwardRecordResponse>(req);
            if (res.DoFlag)
            {
                result.List = Mapper.MappGereric<Web_Award_RecordExt, WebAwardRecordDetail>(res.WebAwardRecordDos);
                result.Total = res.Total;
            }
            result.SearchDetail = recordDetail.SearchDetail;
            result.PageIndex = recordDetail.PageIndex;
            result.PageSize = recordDetail.PageSize;
            return result;
        }
        #endregion

        #region 拉取特殊奖品明细
        /// <summary>
        /// 拉取特殊奖品明细
        /// </summary>
        /// <param name="intawardid"></param>
        /// <param name="dtCreateTime"></param>
        /// <param name="dtEndCreateTime"></param>
        /// <returns></returns>
        public List<WebAwardRecordDetail> QueryWebAwardRecordSpecial(int intawardid, DateTime dtCreateTime, DateTime dtEndCreateTime)
        {
            var result = new List<WebAwardRecordDetail>();
            var req = new QueryWebAwardRecordSpecialRequest();
            req.IntAwardId = intawardid;
            req.DtStartCreateTime = dtCreateTime;
            req.DtEndCreateTime = dtEndCreateTime;

            var res = MKMSClient.Send<QueryWebAwardRecordSpecialResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.MappGereric<Web_Award_RecordExt, WebAwardRecordDetail>(res.WebAwardRecordDos);
            }
            return result;
        }
        #endregion

        //***********************dbo.其他*********************************

        #region 检测商品Id是否存在商品表中
        /// <summary>
        /// 检测商品Id是否存在商品表中
        /// </summary>
        /// <param name="productId"></param>
        /// <param name="str"></param>
        /// <returns></returns>
        public bool CheckPdtInfoById(int productId, out string str)
        {
            var req = new QueryPdtBaseInfoByIdRequest();
            req.IntProductID = productId;
            var res = OpcClient.Send<QueryPdtBaseInfoByIdResponse>(req);
            if (res.PdtBaseInfoDos != null)
            {
                str = res.PdtBaseInfoDos.VchProductName;
            }
            str = "";
            return res.DoFlag;
        }
        #endregion

        #region  获取当所有指定优惠券ID的券信息
        /// <summary>
        ///  获取当所有指定优惠券ID的券信息
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public CouponsInfoDetail QueryCouponsInfo(int id)
        {
            var result = new CouponsInfoDetail();
            var req = new QueryCouponsInfoRequest();
            req.CouponId = id;
            var res = MKMSClient.Send<QueryCouponsInfoResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<CouponsInfoExt, CouponsInfoDetail>(res.CouponsInfoDos);
            }
            return result;
        }
        #endregion

        #region 获取当所有指定优惠码ID的码信息
        /// <summary>
        /// 获取当所有指定优惠码ID的码信息
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        public CouponActivityDetail QueryCouponActivityDetail(int id)
        {
            var result = new CouponActivityDetail();
            var req = new QueryCouponActivityRequest();
            req.CouponActId = id;
            var res = MKMSClient.Send<QueryCouponActivityResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<CouponActivityExt, CouponActivityDetail>(res.CouponActivityDos);
            }
            return result;
        }
        #endregion

        #region 获取当前促销区域信息
        /// <summary>
        /// 获取当前促销区域信息
        /// </summary>
        /// <param name="couponActId"></param>
        /// <returns></returns>
        public List<CouponPromotionsDetail> QueryCouponPromotions(int couponActId)
        {
            var result = new List<CouponPromotionsDetail>();
            var req = new QueryCouponPromotionsRequest();
            req.CouponActId = couponActId;
            var res = MKMSClient.Send<QueryCouponPromotionsResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.MappGereric<CouponPromotionsExt, CouponPromotionsDetail>(res.CouponPromotionsDos);
            }
            return result;
        }
        #endregion

        #region 获取当前促销区域促销活动
        /// <summary>
        /// 获取当前促销区域促销活动
        /// </summary>
        /// <param name="promId"></param>
        /// <returns></returns>
        public PromInfoDetail QueryPromInfo(int promId)
        {
            var result = new PromInfoDetail();
            var req = new QueryPromInfoRequest();
            req.PromId = promId;
            var res = MKMSClient.Send<QueryPromInfoResponse>(req);
            if (res.DoFlag)
            {
                result = Mapper.Map<PromInfoExt, PromInfoDetail>(res.PromInfoDos);
            }
            return result;
        }
        #endregion

    }
}